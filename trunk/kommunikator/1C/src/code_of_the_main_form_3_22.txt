ѕерем XMLHttp;


ѕроцедура —охранитьЌажатие(Ёлемент)
	
	“екст = Ќовый “екстовыйƒокумент();
	“екст.ƒобавить—троку(¬нутреннийЌомер);
	“екст.ƒобавить—троку(ѕароль);	
	“екст.ƒобавить—троку(—ервер) ;
	WSS=Ќовый COMќбъект("WScript.Shell");
	—ообщить(WSS.SpecialFolders().Item("AppData"));
	“екст.«аписать(WSS.SpecialFolders().Item("AppData")+"PersonalDetails");
	
	ѕользователь = ѕараметры—еанса.“екущийѕользователь.ѕолучитьќбъект();
	ѕользователь.«аписать();
	
	јвторизаци€();

	   	
 онецѕроцедуры                   

ѕроцедура ѕозвонитьЌажатие()
	
	 —сылка ="http://"  + —окрЋѕ(—ервер)+"//service/data.php?action=make_call&session="+—окрЋѕ(—есси€)+"&number="+—окрЋѕ(Ќомер“елефона);
	 —ообщить(—сылка);
	 XMLHttp.Open("GET", —сылка, False);
	 XMLHttp.Send();
	 ќтвет—ервера = XMLHttp.responseText;
	 —ообщить(ќтвет—ервера);
	 ≈сли Ќайти(ќтвет—ервера,"true") > 0 “огда
		 —ообщить("ѕодключились");
		 Ќомер“елефона = —окрЋѕ(—ред(ќтвет—ервера,Ќайти(ќтвет—ервера,"number")+6));
		 //ѕоискјбонента(—окрЋѕ(Ќомер“елефона));
	 »наче≈сли  Ќайти(ќтвет—ервера,"false") > 0 “огда
		 —ообщить(—ред(ќтвет—ервера,28,—трƒлина(ќтвет—ервера)-30));
	  онец≈сли;
	 
		 
  онецѕроцедуры

ѕроцедура ЌайтиЌажатие(Ёлемент)   //ѕоиск по введенной строке
	≈сли Ќе —трокаѕоиска ="" тогда
	 
	–езультатѕоиска—писок.ќчистить();
	—писокЌомеров онтактногоЋица.ќчистить();
	Ќомер“елефона = "";
		
	«апросѕоиска = Ќовый «апрос;
	«апросѕоиска.“екст = "¬џЅ–ј“№
	                     |	 онтактна€»нформаци€.ќбъект
	                     |»«
	                     |	–егистр—ведений. онтактна€»нформаци€  ј   онтактна€»нформаци€
	                     |√ƒ≈
	                     | онтактна€»нформаци€.ѕредставление ѕќƒќЅЌќ &Ќаименование";
	//«апросѕоиска.”становитьѕараметр("Ќаименование",—окрЋѕ(—трокаѕоиска));
	«апросѕоиска.”становитьѕараметр("Ќаименование","%"+—окрЋѕ(—трокаѕоиска)+"%");
	–езультат«апроса = «апросѕоиска.¬ыполнить().¬ыгрузить();
	≈сли –езультат«апроса. оличество() <> 0 “огда
		ƒл€ каждого —трока »з –езультат«апроса ÷икл
			Ќов = –езультатѕоиска—писок.ƒобавить();
			Ќов.ќбъект= —трока.ќбъект;
		
		 онец÷икла;
		
		 	»наче —ообщить("ѕо номеру "+—трокаѕоиска+" ничего не найдено!");
		—писокЌомеров онтактногоЋица.ќчистить();
		//–езультатѕоиска—писок = "";
		—трокаѕоиска = "";
		Ќомер“елефона = "";
		»нформаци€ќ онтактномЋице = "";
	 онец≈сли;
		
  онец≈сли;

		
 онецѕроцедуры

ѕроцедура ѕриќткрытии()
	//ищем текстовик с персональными данными
	ѕользователь— = ѕараметры—еанса.“екущийѕользователь;
	WSS=Ќовый COMќбъект("WScript.Shell");
	ѕопытка
		
	  //логин, пароль, сервер берем из текстовика
	“екст = Ќовый “екстовыйƒокумент();
	“екст.ѕрочитать(WSS.SpecialFolders().Item("AppData")+"PersonalDetails");
	—тр = “екст.ѕолучить—троку(1);
	¬нутреннийЌомер = —тр;
	—тр2 = “екст.ѕолучить—троку(2);
	ѕароль = —тр2;
	—тр3 = “екст.ѕолучить—троку(3);
	—ервер = —тр3;	
»сключение  
	
	//устанавливаем изначально стандартные настройки
	  Ўрифт = Ўрифты—тил€.Ўрифт“екста;
	  ÷ветѕол€ = ÷вета—тил€.÷вет‘онаѕол€;
	  ÷вет–амки = ÷вета—тил€.÷вет–амки;
	  ÷вет“екста= ÷вета—тил€.÷вет“екстаѕол€;
	  ÷вет‘она = ÷вета—тил€.÷вет‘она‘ормы;
	  ÷вет нопки = ÷вета—тил€.÷вет‘она нопки;
	//Ёлементы‘ормы.¬нутреннийЌомер.÷вет“екстаѕол€= ÷вета—тил€.÷вет“екстаѕол€;
	
	
	Ёта‘орма.ѕанель.“екуща€—траница = Ёта‘орма.ѕанель.—траницы.Ќастройки;
	   –ежим = –ежимƒиалога¬опрос.ќ ;
	   ќтвет = ¬опрос("Ќеобходимо заполнить настройки подключени€!",–ежим,,,"ќшибка соединени€");  
		  ≈сли ќтвет =  од¬озвратаƒиалога.ќ  “огда
			  ¬нутреннийЌомер = "";
			  ѕароль = "";
			  —ервер = "";
			  ¬озврат;
				
   		   онец≈сли;

        ¬озврат;
     онецѕопытки;	
	  
	≈сли “аймаут—екунд = 0 “огда
		“аймаут—екунд = 5;
	 онец≈сли;
	“айм = 0;
	ѕользователь— = ѕараметры—еанса.“екущийѕользователь;
	ѕользователь = ѕараметры—еанса.“екущийѕользователь;
	
//≈сли дл€ фона формы уже выбрана картинка, используетс€ последн€€ выбранна€ картинка	
 ѕопытка
	≈сли ‘лажок1 = 1 “огда
		 артинка = Ќовый  артинка(WSS.SpecialFolders().Item("AppData")+"background");
		ѕанель. артинка =  артинка;
		÷вет‘она = ѕанель.÷вет‘она; 
		÷вет‘она = Ћожь;
		Ёлементы‘ормы.ѕоле алендар€1.÷вет‘она нопки =  ÷ветѕол€;
	Ёлементы‘ормы.ѕоле алендар€1.÷вет‘онаѕол€ =÷ветѕол€;
 онец≈сли;
»сключение;
¬озврат;
 онецѕопытки;


//если картинка фона не установлена, тогда используетс€ либо стандартна€ настройка, либо установленна€ пользователем.
≈сли ‘лажок1 = 0 “огда
		Ёлементы‘ормы.ƒействи€‘ормы.÷вет‘она = ÷вет‘она;
	Ёлементы‘ормы.ѕоле алендар€1.÷вет‘она нопки =  ÷вет‘она;
	Ёлементы‘ормы.ѕоле алендар€1.÷вет‘онаѕол€ =  ÷вет‘она;
	ѕанель.÷вет‘она = ÷вет‘она;
	   онец≈сли;


	
    

		  
	≈сли —окрЋѕ(—ервер) <> "" » —окрЋѕ(ѕароль) <> "" » —окрЋѕ(¬нутреннийЌомер)<> "" “огда
		ќбновитьƒанныеќ онтактномЋице(—правочники. онтрагенты.ѕуста€—сылка());
		јвторизаци€();
		ѕодключитьќбработчикќжидани€("—осто€ниеѕриема", “аймаут—екунд); 
		
	»наче 
		Ёта‘орма.ѕанель.“екуща€—траница = Ёта‘орма.ѕанель.—траницы.Ќастройки;
		—ообщить("«аполните настройки подключени€.");
		
	 онец≈сли;
	
//	устанавливаем цвет текста элементов
  Ёлементы‘ормы.‘лажок1.÷вет“екста =÷вет“екста;
   Ёлементы‘ормы. онтактноеЋицо.÷вет“екста нопки = ÷вет“екста;
   Ёлементы‘ормы. онтрагент.÷вет“екста нопки =÷вет“екста;
   Ёлементы‘ормы.¬нутреннийЌомер.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.÷вет“екста.÷вет“екста нопки =     ÷вет“екста;
   Ёлементы‘ормы.Ќадпись¬нутреннийЌомер.÷вет“екста=  ÷вет“екста;
   Ёлементы‘ормы.Ќадпись»нформаци€ќ онтактномЋице.÷вет“екста= ÷вет“екста;
   Ёлементы‘ормы.ЌадписьЌомер“елефона.÷вет“екста=  ÷вет“екста;
   Ёлементы‘ормы.Ќадписьѕароль.÷вет“екста =  ÷вет“екста;
   Ёлементы‘ормы.Ќадпись—ервер.÷вет“екста=÷вет“екста;
   Ёлементы‘ормы.Ќадпись“аймаут.÷вет“екста=  ÷вет“екста;
   Ёлементы‘ормы.Ќайти.÷вет“екста нопки= ÷вет“екста;
   Ёлементы‘ормы.Ќомер“елефона.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.ѕароль.÷вет“екстаѕол€ =÷вет“екста; 
   Ёлементы‘ормы.ѕозвонить.÷вет“екста нопки=   ÷вет“екста;
   Ёлементы‘ормы.ѕоле алендар€1.÷вет“екстаѕол€=   ÷вет“екста;
   Ёлементы‘ормы.ѕользователь—.÷вет“екстаѕол€=÷вет“екста;
   Ёлементы‘ормы.–езультатѕоиска—писок.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.сек.÷вет“екста=  ÷вет“екста;
   Ёлементы‘ормы.—ервер.÷вет“екстаѕол€ =÷вет“екста;
   Ёлементы‘ормы.—оздать—обытие.÷вет“екста нопки=  ÷вет“екста;
   Ёлементы‘ормы.—охранить.÷вет“екста нопки=  ÷вет“екста;
   Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.—трокаѕоиска.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.“аймаут—екунд.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.ƒействи€‘ормы.÷вет“екста нопки =÷вет“екста;
   ѕанель.÷вет“екста = ÷вет“екста;
   ѕанель.÷вет“екстаѕол€ = ÷вет“екста;
   Ёлементы‘ормы. артинка‘она.÷вет“екста нопки = ÷вет“екста;
   Ёлементы‘ормы.‘лажок1.÷вет“екста =÷вет“екста;
   Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет“екстаЎапки=÷вет“екста;
   Ёлементы‘ормы.–езультатѕоиска—писок.÷вет“екстаЎапки = ÷вет“екста;
   Ёлементы‘ормы.ѕоле алендар€1.÷вет“екста нопки = ÷вет“екста;
	Ёлементы‘ормы.Ќастройка÷вета.÷вет“екста =÷вет“екста;
Ёлементы‘ормы.Ќадп—оздать.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.Ќадпись÷вет нопки.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.Ќадпись÷вет–амки.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.Ќадпись÷вет“екста.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.Ќадпись÷вет‘она.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.ѕоле.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.ЌадписьЎрифт.÷вет“екста = ÷вет“екста;

	//цвет кнопки   
 Ёлементы‘ормы.Ќомер“елефона.÷вет‘она нопки = ÷вет нопки;
   Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет‘она нопки= ÷вет нопки;
   Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет‘онаЎапки=÷вет нопки;
   Ёлементы‘ормы. онтрагент.÷вет‘она нопки = ÷вет нопки;
   Ёлементы‘ормы. онтактноеЋицо.÷вет‘она нопки =  ÷вет нопки;
   Ёлементы‘ормы.—оздать—обытие.÷вет‘она нопки =÷вет нопки;
   Ёлементы‘ормы.–езультатѕоиска—писок.÷вет‘онаЎапки = ÷вет нопки;
   Ёлементы‘ормы.—трокаѕоиска.÷вет‘она нопки =  ÷вет нопки;
   Ёлементы‘ормы.Ќайти.÷вет‘она нопки =  ÷вет нопки;
   Ёлементы‘ормы.—охранить.÷вет‘она нопки =    ÷вет нопки;
  Ёлементы‘ормы.ѕозвонить.÷вет‘она нопки =  ÷вет нопки;
   Ёлементы‘ормы. артинка‘она.÷вет‘она нопки =÷вет нопки;
   Ёлементы‘ормы.ѕоле алендар€1.÷вет‘она нопки = ÷вет нопки;

      //цвет щрифта
	  Ёлементы‘ормы.‘лажок1.Ўрифт = Ўрифт;
Ёлементы‘ормы. онтрагент.Ўрифт =Ўрифт;
Ёлементы‘ормы. онтактноеЋицо.Ўрифт = Ўрифт;
Ёлементы‘ормы.¬нутреннийЌомер.Ўрифт = Ўрифт;
Ёлементы‘ормы.ƒействи€‘ормы.Ўрифт = Ўрифт;
Ёлементы‘ормы.»нформаци€ќ онтактномЋице.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадпись¬нутреннийЌомер.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадпись»нформаци€ќ онтактномЋице.Ўрифт =Ўрифт;
Ёлементы‘ормы.ЌадписьЌомер“елефона.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадписьѕароль.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадпись—ервер.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадпись“аймаут.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќомер“елефона.Ўрифт = Ўрифт;
Ёлементы‘ормы.ќсновныеƒействи€‘ормы.Ўрифт = Ўрифт;
Ёлементы‘ормы.ѕароль.Ўрифт = Ўрифт;
Ёлементы‘ормы.ѕозвонить.Ўрифт =Ўрифт;
Ёлементы‘ормы.ѕоле алендар€1.Ўрифт = Ўрифт;
Ёлементы‘ормы.ѕользователь—.Ўрифт = Ўрифт;
Ёлементы‘ормы.–езультатѕоиска—писок.Ўрифт = Ўрифт;
Ёлементы‘ормы.сек.Ўрифт = Ўрифт;
Ёлементы‘ормы.—ервер.Ўрифт =Ўрифт;
Ёлементы‘ормы.—оздать—обытие.Ўрифт = Ўрифт;
Ёлементы‘ормы.—охранить.Ўрифт = Ўрифт;
Ёлементы‘ормы.—писокЌомеров онтактногоЋица.Ўрифт = Ўрифт; 
Ёлементы‘ормы.—трокаѕоиска.Ўрифт = Ўрифт;
Ёлементы‘ормы.“аймаут—екунд.Ўрифт = Ўрифт;
Ёлементы‘ормы.÷вет‘она.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќайти.Ўрифт = Ўрифт;
Ёлементы‘ормы. артинка‘она.Ўрифт = Ўрифт;
Ёлементы‘ормы.‘лажок1.Ўрифт = Ўрифт;
Ёлементы‘ормы.—писокЌомеров онтактногоЋица.Ўрифт =Ўрифт;
Ёлементы‘ормы.–езультатѕоиска—писок.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќастройка÷вета.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадп—оздать.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадпись÷вет нопки.Ўрифт= Ўрифт;
Ёлементы‘ормы.Ќадпись÷вет–амки.Ўрифт= Ўрифт;
Ёлементы‘ормы.Ќадпись÷вет“екста.Ўрифт= Ўрифт;
Ёлементы‘ормы.Ќадпись÷вет‘она.Ўрифт=Ўрифт;
Ёлементы‘ормы.ѕоле.Ўрифт= Ўрифт;
Ёлементы‘ормы.ЌадписьЎрифт.Ўрифт = Ўрифт;


        //цвет рамка
		
	Ёлементы‘ормы.¬нутреннийЌомер.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.Ќомер“елефона.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.ѕароль.÷вет–амки =÷вет–амки; 
	Ёлементы‘ормы.–езультатѕоиска—писок.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.—ервер.÷вет–амки =÷вет–амки; 
	Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.—трокаѕоиска.÷вет–амки=÷вет–амки;
	Ёлементы‘ормы.“аймаут—екунд.÷вет–амки= ÷вет–амки;
	ѕанель.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.–амка√руппы1.÷вет–амки = ÷вет–амки;
	Ёлементы‘ормы.–амка√руппы2.÷вет–амки = ÷вет–амки;
Ёлементы‘ормы.ѕозвонить.÷вет–амки =   ÷вет–амки;
     Ёлементы‘ормы. онтрагент.÷вет–амки =   ÷вет–амки;
	 Ёлементы‘ормы. онтактноеЋицо.÷вет–амки =  ÷вет–амки;
	 Ёлементы‘ормы.—оздать—обытие.÷вет–амки =  ÷вет–амки;
	 Ёлементы‘ормы.Ќайти.÷вет–амки =   ÷вет–амки;
	   Ёлементы‘ормы. артинка‘она.÷вет–амки = ÷вет–амки;
	  Ёлементы‘ормы.—охранить.÷вет–амки = ÷вет–амки;
	  Ёлементы‘ормы.÷вет нопки.÷вет–амки =  ÷вет–амки;
	  Ёлементы‘ормы.÷ветѕол€.÷вет–амки =   ÷вет–амки;
	  Ёлементы‘ормы.÷вет–амки.÷вет–амки =   ÷вет–амки;
	  Ёлементы‘ормы.÷вет“екста.÷вет–амки =  ÷вет–амки;
	  Ёлементы‘ормы.÷вет‘она.÷вет–амки =   ÷вет–амки;
	   Ёлементы‘ормы.Ўрифт.÷вет–амки = ÷вет–амки;

	 
     //цвет пол€
	 
	 	Ёлементы‘ормы.Ќомер“елефона.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.–езультатѕоиска—писок.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.¬нутреннийЌомер.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.ѕароль.÷вет‘онаѕол€ =÷ветѕол€;
	Ёлементы‘ормы.—ервер.÷вет‘онаѕол€ =  ÷ветѕол€;
	Ёлементы‘ормы.“аймаут—екунд.÷вет‘онаѕол€ =   ÷ветѕол€;
	Ёлементы‘ормы.—трокаѕоиска.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.ѕользователь—.÷вет‘онаѕол€ = ÷ветѕол€;

	
	ѕоле¬вода1 =Ќачалоƒн€(“екуща€ƒата());
   онецѕроцедуры

‘ункци€ Ќайти„исло¬—троке(—трока—Ќомером“елефона)
	—трока„исел = "";
	ƒл€ »ндекс = 1 ѕо —трƒлина(—трока—Ќомером“елефона) ÷икл
		—имвол = —ред(—трока—Ќомером“елефона, »ндекс, 1); //ѕеребираем все символы в строке с телефоном
		≈сли  од—имвола(—имвол) >= 48 »  од—имвола(—имвол) <= 57 “огда // код "0"=48, "9"=57
			—трока„исел = —трока„исел + —имвол;
		 онец≈сли;
	 онец÷икла;
	
	¬озврат —трока„исел;
 онец‘ункции

ѕроцедура јвторизаци€()
    —сылка = "http://"  + —окрЋѕ(—ервер)+"//service/data.php?action=auth&extension="+—окрЋѕ(¬нутреннийЌомер)+"&password="+—окрЋѕ(ѕароль);
    —ообщить(—сылка);
	XMLHttp = GetCOMObject("", "Microsoft.XMLHTTP");
	XMLHttp.Open("GET", —сылка, False);
	XMLHttp.Send();
	ќтвет—ервера = XMLHttp.responseText;
		
	–езультатћассив = —трока¬ћассив(ќтвет—ервера,);
	ћо€—труктура = Ќовый —труктура("ƒоступ","—есси€");
    ƒл€ каждого Ёлементћассива »з –езультатћассив ÷икл
      Ёлемент = —тр«аменить(Ёлементћассива, """","");
	  Ёлемент = —тр«аменить(Ёлемент, "{","");
	 	  ≈сли Ќайти(Ёлемент,"true") > 0 “огда
	      ћо€—труктура.¬ставить("ƒоступ", "true");
      »наче≈сли Ќайти(Ёлемент,"false") > 0 “огда
		  ћо€—труктура.¬ставить("ƒоступ", "false");
		  –ежим = –ежимƒиалога¬опрос.ќ ;
		  ќтвет = ¬опрос("ѕроверьте наличие и правильность номера и парол€!!!",–ежим,,,"ќшибка соединени€");  
		  ≈сли ќтвет =  од¬озвратаƒиалога.ќ  “огда
			  ¬озврат;
		   онец≈сли;
		  
			  
      »наче≈сли Ќайти(Ёлемент,"session_id") > 0 “огда
		  «начение = Ћев(—тр«аменить(Ёлемент, "session_id:",""),—трƒлина(—тр«аменить(Ёлемент, "session_id:","")));
		  ћо€—труктура.¬ставить("—есси€",«начение);
		  —есси€ = «начение;
		  //—ообщить(—есси€);
		  //—осто€ниеѕриема();
		 
	   онец≈сли;
      
     онец÷икла;
	
 онецѕроцедуры

‘ункци€ —трока¬ћассив(«нач «начение, –азделитель = ",") Ёкспорт
        ћн—тр = —тр«аменить( «начение, –азделитель, —имволы.ѕ—);
        –езультатћассив = Ќовый ћассив;
		ƒл€ й = 1 ѕо —тр„исло—трок(ћн—тр) ÷икл
            –езультатћассив.ƒобавить(—трѕолучить—троку(ћн—тр,й));
         онец÷икла;
        ¬озврат –езультатћассив;
	 онец‘ункции

ѕроцедура —осто€ниеѕриема()
	—сылка = "http://" + —окрЋѕ(—ервер)+"//service/data.php?action=get_state&session="+—окрЋѕ(—есси€);
	
	 XMLHttp.Open("GET", —сылка, False);
	 XMLHttp.Send();
	 ќтвет—ервера = XMLHttp.responseText;
	 //
 	//ќтвет—ервера = "success:true,status:online,incoming_call:{time:01.01.12 12:00:00,number:000}"; 
 	//
 	≈сли Ќайти(ќтвет—ервера,"incoming_call") > 0 “огда
    	 –езультатћассив = —трока¬ћассив(ќтвет—ервера,);
    	 ƒл€ каждого Ёлементћассива »з –езультатћассив ÷икл
    		
    			 //Ёлемент = —тр«аменить(Ёлемент, "{","");
    			 ≈сли Ќайти(Ёлементћассива,"time") > 0 “огда
    			    ¬рем€ = ѕрав(—окрЋѕ(Ёлементћассива),17); 
			     »наче≈сли Ќайти(Ёлементћассива,"number") > 0 “огда
				    —ообщить(Ёлементћассива);
				    Ёлемент = —тр«аменить(Ёлементћассива, "}","");
				    Ёлемент = —тр«аменить(Ёлемент, "}","");
                    Ёлемент = —тр«аменить(Ёлемент, """","");
				    —ообщить(Ёлемент);
				    Ќомер“елефона = ѕрав(—окрЋѕ(Ёлемент),—трƒлина(Ёлемент)-Ќайти(Ёлемент,":"));
					
			  онец≈сли;

          онец÷икла;
 
		—ообщить("ѕоступил звонок в "+¬рем€ +", от абонента "+Ќомер“елефона);
		
	  ѕоискјбонента(—окрЋѕ(Ќомер“елефона));
		
		//открываем инф окно
		ќтключитьќбработчикќжидани€("—осто€ниеѕриема");
		‘орма»нформации = Ётотќбъект.ѕолучить‘орму("»нформаци€ онтактногоЋица");
        ‘орма»нформации.ќткрыть();
				ѕодключитьќбработчикќжидани€("—осто€ниеѕриема", “аймаут—екунд);	
		—ообщить("вкл");
	  онец≈сли;
		 
  онецѕроцедуры
       
 ѕроцедура ѕоискјбонента(Ќомер“елефона)
	 ќтвет—ервера = XMLHttp.responseText;
	 ≈сли Ќе 
		 Ќайти(ќтвет—ервера,"incoming_call") > 0 “огда
   	       –езультатѕоиска—писок.ќчистить();
		    онец≈сли;
		«апрос = Ќовый «апрос;
	«апрос.“екст = "¬џЅ–ј“№
				   |	 онтактна€»нформаци€.ќбъект,
				   |	 онтактна€»нформаци€.ѕредставление
				   |»«
				   |	–егистр—ведений. онтактна€»нформаци€  ј   онтактна€»нформаци€
				   |√ƒ≈
				   |	 онтактна€»нформаци€.“ип = &“ип онтактной»нформации";
	«апрос.”становитьѕараметр("“ип онтактной»нформации",ѕеречислени€.“ипы онтактной»нформации.“елефон);
	
	
	–езультат = «апрос.¬ыполнить();
	
	≈сли Ќ≈ –езультат.ѕустой() “огда
		¬ыборка = –езультат.¬ыбрать();
		
		ѕока ¬ыборка.—ледующий() ÷икл
			ЌайденыйЌомер = Ќайти„исло¬—троке(—окрЋѕ(¬ыборка.ѕредставление));
			//≈сли ЌайденыйЌомер = Ќомер“елефона “огда
			≈сли Ќайти(ЌайденыйЌомер,Ќомер“елефона) “огда
				»нформаци€ќ онтактномЋице = ¬ыборка.ќбъект;
				≈сли »нформаци€ќ онтактномЋице = —правочники. онтрагенты.ѕуста€—сылка() “огда
					 онтактноеЋицо = ¬ыборка.ќбъект; 
					»нформаци€ќ онтактномЋице = ¬ыборка.ќбъект.¬ладелец;
					
				 онец≈сли;
				
				ќбновитьƒанныеќ онтактномЋице(»нформаци€ќ онтактномЋице);
				ѕрервать;
			»наче  
				»нформаци€ќ онтактномЋице = —правочники. онтрагенты.ѕуста€—сылка();
				//—писокЌомеров онтактногоЋица.ќчистить();
			 онец≈сли;

		 онец÷икла;
	
	»наче 
		—ообщить(" онтактное лицо не найдено");
		—писокЌомеров онтактногоЋица.ќчистить();
	 онец≈сли;
	
	≈сли »нформаци€ќ онтактномЋице = —правочники. онтрагенты.ѕуста€—сылка() “огда
		—ообщить(" онтактное лицо не найдено");
		—писокЌомеров онтактногоЋица.ќчистить();
	 онец≈сли;	

		  


 онецѕроцедуры


ѕроцедура ќбновитьƒанныеќ онтактномЋице(»нформаци€ќ онтакте)  	
	       ≈сли Ќ≈ »нформаци€ќ онтакте = —правочники. онтрагенты.ѕуста€—сылка() “огда
//	ѕопытка
		//»нформаци€ќ онтакте = —правочники. онтрагенты.—оздатьЁлемент();		  
			»нформаци€ќ онтакте.ѕолучитьќбъект();
		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.ќбъект;
		ќтборƒанныхќ онтактномЋице.«начение = »нформаци€ќ онтактномЋице;
		ќтборƒанныхќ онтактномЋице.»спользование = »стина;	
		
		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.“ип;
		ќтборƒанныхќ онтактномЋице.«начение = ѕеречислени€.“ипы онтактной»нформации.“елефон;
		ќтборƒанныхќ онтактномЋице.»спользование = »стина;
	   онец≈сли;

	
	//	≈сли Ќ≈ »нформаци€ќ онтакте = —правочники. онтрагенты.ѕуста€—сылка() “огда
	////ѕопытка
	//	//»нформаци€ќ онтакте = —правочники. онтрагенты.—оздатьЁлемент();		  
	//		»нформаци€ќ онтакте.ѕолучитьќбъект();
	//	ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.ќбъект;
	//	ќтборƒанныхќ онтактномЋице.«начение = »нформаци€ќ онтакте;
	//	ќтборƒанныхќ онтактномЋице.»спользование = »стина;	
	//	
	//	ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.“ип;
	//	ќтборƒанныхќ онтактномЋице.«начение = ѕеречислени€.“ипы онтактной»нформации.“елефон;
	//	ќтборƒанныхќ онтактномЋице.»спользование = »стина;

			//»нформаци€ќ онтакте = —правочники. онтрагенты.ѕуста€—сылка()
	
	
		//≈сли Ќ≈ »нформаци€ќ онтакте = —правочники. онтрагенты.ѕуста€—сылка() “огда

//			 »нформаци€ќ онтакте = —правочники. онтрагенты.ѕолучить—сылку().ѕолучитьќбъект();
//			
//		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.ќбъект;
//		ќтборƒанныхќ онтактномЋице.«начение = »нформаци€ќ онтакте;
//		ќтборƒанныхќ онтактномЋице.»спользование = »стина;	
//		
//		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.“ип;
//		ќтборƒанныхќ онтактномЋице.«начение = ѕеречислени€.“ипы онтактной»нформации.“елефон;
//		ќтборƒанныхќ онтактномЋице.»спользование = »стина;
		  // онец≈сли;


 онецѕроцедуры

ѕроцедура Ќомер“елефонаѕри»зменении(Ёлемент)
	ѕоискјбонента(—окрЋѕ(Ќомер“елефона));
	 онецѕроцедуры

ѕроцедура —трокаѕоискајвтоѕодбор“екста(Ёлемент, “екст, “екстјвтоѕодбора, —тандартна€ќбработка)
	//ѕроцедурыѕоискаѕо—троке.јвтоѕодбор“екста¬Ёлементе”правлени€();
 онецѕроцедуры


ѕроцедура —писокЌомеров онтактногоЋицаѕријктивизации—троки(Ёлемент)
	
	
	//Ќомер“елефона = 	 Ёлементы‘ормы.—писокЌомеров онтактногоЋица.¬ыделенные—троки;
	//	“екуща€—трока = Ёлементы‘ормы.–езультатѕоиска—писок.“екущиеƒанные;  
	//
		 онецѕроцедуры

ѕроцедура ѕри«акрытии()
	ѕопытка
	Ётотќбъект.ѕолучить‘орму("»нформаци€ онтактногоЋица").«акрыть();
»сключение;
	 онецѕопытки;
 онецѕроцедуры

ѕроцедура  онтрагентЌажатие(Ёлемент)
	 онтрагент = —правочники. онтрагенты.ѕолучить‘ормуЌовогоЁлемента("‘ормаЁлемента");
	 онтрагент.ќткрыть();
 онецѕроцедуры

ѕроцедура  онтактноеЋицоЌажатие(Ёлемент)
	 онтЋицо = —правочники. онтактныеЋица.ѕолучить‘ормуЌовогоЁлемента("‘ормаЁлемента");
	 онтЋицо.ќткрыть();
 онецѕроцедуры

 ѕроцедура —оздать—обытиеЌажатие(Ёлемент)
	¬вестиЌовое—обытие(Ћожь, Ќеопределено, ѕеречислени€.¬иды—обытий.“елефонный«вонок);

 онецѕроцедуры
	
ѕроцедура ¬вестиЌовое—обытие( опирование = Ћожь, Ёлемент = Ќеопределено, ¬ыбранный¬ид—обыти€)

	//≈сли Ќ≈ –абота—ƒиалогами.«аписатьЌовыйќбъект¬‘орме(»нформаци€ќ онтактномЋице.ѕолучить‘орму()) “огда
	//	¬озврат;
	// онец≈сли; 

	≈сли  опирование “огда
		≈сли Ёлемент.“екуща€—трока <> Ќеопределено » Ќ≈ Ёлемент.“екуща€—трока.ѕуста€() “огда
			Ёлемент.“екуща€—трока.—копировать().ѕолучить‘орму(,Ёта‘орма).ќткрыть();
		 онец≈сли;
	»наче
		
		≈сли ¬ыбранный¬ид—обыти€ = Ќеопределено “огда
			
			—писок¬ыбора = Ќовый —писок«начений;
			ƒл€ каждого ¬ид—обыти€ »з ѕеречислени€.¬иды—обытий ÷икл
				Ёлемент—писка = —писок¬ыбора.ƒобавить(¬ид—обыти€, —трока(¬ид—обыти€));
				Ёлемент—писка. артинка = ”правление онтактами.ѕолучить артинкуЌапоминани€(¬ид—обыти€);
			 онец÷икла; 

			≈сли Ёлемент <> Ќеопределено » Ёлемент.“екущиеƒанные <> Ќеопределено » Ќ≈ Ёлемент.“екущиеƒанные.—сылка.ѕуста€() “огда
				«начени€ѕоиска¬—писке = Ёлемент.“екущиеƒанные.¬ид—обыти€;
			 онец≈сли;

			ЌайденныйЁлемент—писка = —писок¬ыбора.Ќайтиѕо«начению(«начени€ѕоиска¬—писке);
			¬ыбранныйЁлемент = —писок¬ыбора.¬ыбратьЁлемент("¬ыберите тип документа", ЌайденныйЁлемент—писка);
			
			≈сли ¬ыбранныйЁлемент <> Ќеопределено “огда
				¬ыбранный¬ид—обыти€ = ¬ыбранныйЁлемент.«начение;
			 онец≈сли; 
			
		 онец≈сли; 
		
		≈сли ¬ыбранный¬ид—обыти€ <> Ќеопределено “огда
			
			ƒок = ƒокументы.—обытие.—оздатьƒокумент();
			
			ƒок.¬ид—обыти€     = ¬ыбранный¬ид—обыти€;
			ƒок. онтрагент     = »нформаци€ќ онтактномЋице;
			//ƒок. онтактноеЋицо = »нформаци€ќ онтактномЋице.ќсновное онтактноеЋицо;
			ƒок. онтактноеЋицо =  онтактноеЋицо;
			ƒок.¬идќбъекта     = ѕеречислени€.¬идыќбъектов—обыти€. онтрагент;

			‘орма—обыти€       = ƒок.
			ѕолучить‘орму(,Ёта‘орма);
			
//			Ёлементы‘ормы.ѕанель.“екуща€—траница = Ёлементы‘ормы.ѕанель.—траницы.—обыти€;
			‘орма—обыти€.—труктураќбъект онтрагент = Ќовый —труктура("ќбъект, «аписыватьќбъект", Ётотќбъект, »стина);
			
			‘орма—обыти€.ќткрыть();
			—ообщить("Ќужно ли здесь открывать окно контрагента? (справочник  онтрагенты)");
		 онец≈сли; 
	 онец≈сли; 
	
 онецѕроцедуры

ѕроцедура —писокЌомеров онтактногоЋицаѕријктивизации олонки(Ёлемент)
	
—тр =Ёлементы‘ормы.—писокЌомеров онтактногоЋица.“екущиеƒанные.ѕредставление;

    RegExp=Ќовый COMќбъект("VBScript.RegExp");
RegExp.MultiLine=Ћожь; 
RegExp.Global=»стина;
RegExp.Pattern = "[^0-9]";
Str1 = —окрЋѕ(—тр);
Res = RegExp.Replace(Str1, "");
  Ќомер“елефона =Res;
 онецѕроцедуры

  
ѕроцедура –езультатѕоиска—писокѕријктивизации олонки(Ёлемент)
	//“екуща€—трока = Ёлементы‘ормы.–езультатѕоиска—писок.“екущиеƒанные;  
	//»нформаци€ќ онтактномЋице = “екуща€—трока.ќбъект;
	//»нформаци€ќ онтакте =  “екуща€—трока.ќбъект;

	//ќбновитьƒанныеќ онтактномЋице(»нформаци€ќ онтакте);	
	////
//≈сли Ќ≈ »нформаци€ќ онтакте = —правочники. онтрагенты.ѕуста€—сылка() “огда
//	ѕопытка
//		»нформаци€ќ онтакте = —правочники. онтрагенты.—оздатьЁлемент();		  
//			»нформаци€ќ онтакте.ѕолучитьќбъект();
//		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.ќбъект;
//		ќтборƒанныхќ онтактномЋице.«начение = »нформаци€ќ онтакте;
//		ќтборƒанныхќ онтактномЋице.»спользование = »стина;	
//		
//		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.“ип;
//		ќтборƒанныхќ онтактномЋице.«начение = ѕеречислени€.“ипы онтактной»нформации.“елефон;
//		ќтборƒанныхќ онтактномЋице.»спользование = »стина;
//	   онец≈сли;
 онецѕроцедуры


ѕроцедура –езультатѕоиска—писокѕријктивизации—троки(Ёлемент)
	 //¬ставить содержимое обработчика.
	 ≈сли Ќе —трокаѕоиска = "" “огда
	“екуща€—трока = Ёлементы‘ормы.–езультатѕоиска—писок.“екуща€—трока;  
	»нформаци€ќ онтактномЋице = “екуща€—трока.ќбъект;
	»нформаци€ќ онтакте =  “екуща€—трока.ќбъект;

	ќбновитьƒанныеќ онтактномЋице(»нформаци€ќ онтакте);	
       онец≈сли;
 онецѕроцедуры

//настройки внешнего вида
//ѕроцедура ÷вет‘онаЌажатие(Ёлемент)
// онецѕроцедуры

//ѕроцедура ‘лажок1ѕри»зменении(Ёлемент)
//	WSS=Ќовый COMќбъект("WScript.Shell");
//	ѕопытка
//		≈сли ‘лажок1 = 1 “огда
//			 артинка = Ќовый  артинка(WSS.SpecialFolders().Item("AppData")+"background");
//			ѕанель. артинка =  артинка;
//			ѕанель.÷вет‘она = ÷вета—тил€.÷вет‘она‘ормы;
//			Ёлементы‘ормы.ƒействи€‘ормы.÷вет‘она =  ÷вета—тил€.÷вет‘она‘ормы;
//			
//			Ёлементы‘ормы.ѕоле алендар€1.÷вет‘онаѕол€ = ÷вета—тил€.÷вет‘она‘ормы;
//			Ёлементы‘ормы.ѕоле алендар€1.÷вет‘она нопки =÷вета—тил€.÷вет‘она‘ормы; 

//			ќбновить();
//		 онец≈сли;
//		
//	»сключение;
//		¬озврат;
//	 онецѕопытки;
//	
// онецѕроцедуры



ѕроцедура  артинка‘онаЌажатие(Ёлемент)
	// выбрать картинку дл€ фона телефонии и сохранить ее в папке с телефонией
//≈сли ‘лажок1=1  “огда	
		ƒиалог = Ќовый ƒиалог¬ыбора‘айла(–ежимƒиалога¬ыбора‘айла.ќткрытие);
ƒиалог.«аголовок = "¬ыберите фон панели";
ƒиалог.ѕолное»м€‘айла = "";
ƒиалог.ѕредварительныйѕросмотр = »стина;
ƒиалог.‘ильтр = 
"¬се картинки (*.bmp;*.dib;*.rle;*.jpg;*.jpeg;*.tif;*.gif;*.png;*.ico;*.wmf;*.emf)|*.bmp;*.dib;*.rle;*.jpg;*.jpeg;*.tif;*.gif;*.png;*.ico;*.wmf;*.emf|" 
+ "‘ормат bmp (*.bmp;*.dib;*.rle)|*.bmp;*.dib;*.rle|"
+ "‘ормат JPEG (*.jpg;*.jpeg)|*.jpg;*.jpeg|"
+ "‘ормат TIFF (*.tif)|*.tif|"
+ "‘ормат GIF (*.gif)|*.gif|"
+ "‘ормат PNG (*.png)|*.png|"
+ "‘ормат icon (*.ico)|*.ico|"
+ "‘ормат метафайл (*.wmf;*.emf)|*.wmf;*.emf|"; // картинки

≈сли ƒиалог.¬ыбрать() “огда
	 артинка‘она = Ќовый  артинка(ƒиалог.ѕолное»м€‘айла,Ћожь);
	ѕанель. артинка =  артинка‘она;
	WSS=Ќовый COMќбъект("WScript.Shell");
		 артинка‘она.«аписать(WSS.SpecialFolders().Item("AppData")+"background");
		
	»наче
	ќтказ = »стина;
	¬озврат;
 онец≈сли;
 онецѕроцедуры



 ѕроцедура ÷вет“екстаѕри»зменении(Ёлемент)
		
   //ƒаем значение каждому элементу телефонии по выбранному цвету текста и сохран€ем
   Ёлементы‘ормы.‘лажок1.÷вет“екста =÷вет“екста;
   Ёлементы‘ормы. онтактноеЋицо.÷вет“екста нопки = ÷вет“екста;
   Ёлементы‘ормы. онтрагент.÷вет“екста нопки =÷вет“екста;
   Ёлементы‘ормы.¬нутреннийЌомер.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.÷вет“екста.÷вет“екста нопки =     ÷вет“екста;
   Ёлементы‘ормы.Ќадпись¬нутреннийЌомер.÷вет“екста=  ÷вет“екста;
   Ёлементы‘ормы.Ќадпись»нформаци€ќ онтактномЋице.÷вет“екста= ÷вет“екста;
   Ёлементы‘ормы.ЌадписьЌомер“елефона.÷вет“екста=  ÷вет“екста;
   Ёлементы‘ормы.Ќадписьѕароль.÷вет“екста =  ÷вет“екста;
   Ёлементы‘ормы.Ќадпись—ервер.÷вет“екста=÷вет“екста;
   Ёлементы‘ормы.Ќадпись“аймаут.÷вет“екста=  ÷вет“екста;
   Ёлементы‘ормы.Ќайти.÷вет“екста нопки= ÷вет“екста;
   Ёлементы‘ормы.Ќомер“елефона.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.ѕароль.÷вет“екстаѕол€ =÷вет“екста; 
   Ёлементы‘ормы.ѕозвонить.÷вет“екста нопки=   ÷вет“екста;
   Ёлементы‘ормы.ѕоле алендар€1.÷вет“екстаѕол€=   ÷вет“екста;
   Ёлементы‘ормы.ѕользователь—.÷вет“екстаѕол€=÷вет“екста;
   Ёлементы‘ормы.–езультатѕоиска—писок.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.сек.÷вет“екста=  ÷вет“екста;
   Ёлементы‘ормы.—ервер.÷вет“екстаѕол€ =÷вет“екста;
   Ёлементы‘ормы.—оздать—обытие.÷вет“екста нопки=  ÷вет“екста;
   Ёлементы‘ормы.—охранить.÷вет“екста нопки=  ÷вет“екста;
   Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.—трокаѕоиска.÷вет“екстаѕол€= ÷вет“екста;
   Ёлементы‘ормы.“аймаут—екунд.÷вет“екстаѕол€= ÷вет“екста;
    Ёлементы‘ормы.ƒействи€‘ормы.÷вет“екста нопки =÷вет“екста;
   ѕанель.÷вет“екста = ÷вет“екста;
   ѕанель.÷вет“екстаѕол€ = ÷вет“екста;
   Ёлементы‘ормы. артинка‘она.÷вет“екста нопки = ÷вет“екста;
   Ёлементы‘ормы.‘лажок1.÷вет“екста =÷вет“екста;
   Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет“екстаЎапки=÷вет“екста;
   Ёлементы‘ормы.–езультатѕоиска—писок.÷вет“екстаЎапки = ÷вет“екста;
   Ёлементы‘ормы.ѕоле алендар€1.÷вет“екста нопки = ÷вет“екста;
	Ёлементы‘ормы.Ќастройка÷вета.÷вет“екста =÷вет“екста;
Ёлементы‘ормы.Ќадп—оздать.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.Ќадпись÷вет нопки.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.Ќадпись÷вет–амки.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.Ќадпись÷вет“екста.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.Ќадпись÷вет‘она.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.ѕоле.÷вет“екста = ÷вет“екста;
Ёлементы‘ормы.ЌадписьЎрифт.÷вет“екста = ÷вет“екста;


  онецѕроцедуры

 ѕроцедура ÷вет нопкиѕри»зменении(Ёлемент)
	//ƒаем значение каждому элементу телефонии по выбранному цвету текста и сохран€ем
   Ёлементы‘ормы.Ќомер“елефона.÷вет‘она нопки = ÷вет нопки;
   Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет‘она нопки= ÷вет нопки;
   Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет‘онаЎапки=÷вет нопки;
   Ёлементы‘ормы. онтрагент.÷вет‘она нопки = ÷вет нопки;
   Ёлементы‘ормы. онтактноеЋицо.÷вет‘она нопки =  ÷вет нопки;
   Ёлементы‘ормы.—оздать—обытие.÷вет‘она нопки =÷вет нопки;
   Ёлементы‘ормы.–езультатѕоиска—писок.÷вет‘онаЎапки = ÷вет нопки;
   Ёлементы‘ормы.—трокаѕоиска.÷вет‘она нопки =  ÷вет нопки;
   Ёлементы‘ормы.Ќайти.÷вет‘она нопки =  ÷вет нопки;
   Ёлементы‘ормы.—охранить.÷вет‘она нопки =    ÷вет нопки; 
   Ёлементы‘ормы.ѕозвонить.÷вет‘она нопки =  ÷вет нопки;
   Ёлементы‘ормы. артинка‘она.÷вет‘она нопки =÷вет нопки;
   Ёлементы‘ормы.ѕоле алендар€1.÷вет‘она нопки = ÷вет нопки;
  онецѕроцедуры

 ѕроцедура ÷вет‘онаѕри»зменении(Ёлемент)
		≈сли ‘лажок1 = 0 “огда
		Ёлементы‘ормы.ƒействи€‘ормы.÷вет‘она = ÷вет‘она;
	Ёлементы‘ормы.ѕоле алендар€1.÷вет‘она нопки =  ÷вет‘она;
	Ёлементы‘ормы.ѕоле алендар€1.÷вет‘онаѕол€ =  ÷вет‘она;
	ѕанель.÷вет‘она = ÷вет‘она;
	  артинка‘она = Ќовый  артинка();
	ѕанель. артинка =  артинка‘она;
	 артинка‘она=Ћожь;
   онец≈сли;

  онецѕроцедуры

 ѕроцедура Ўрифтѕри»зменении(Ёлемент)
	//мен€ем шрифт объектов телефонии
Ёлементы‘ормы.‘лажок1.Ўрифт = Ўрифт;
Ёлементы‘ормы. онтрагент.Ўрифт =Ўрифт;
Ёлементы‘ормы. онтактноеЋицо.Ўрифт = Ўрифт;
Ёлементы‘ормы.¬нутреннийЌомер.Ўрифт = Ўрифт;
Ёлементы‘ормы.ƒействи€‘ормы.Ўрифт = Ўрифт;
Ёлементы‘ормы.»нформаци€ќ онтактномЋице.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадпись¬нутреннийЌомер.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадпись»нформаци€ќ онтактномЋице.Ўрифт =Ўрифт;
Ёлементы‘ормы.ЌадписьЌомер“елефона.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадписьѕароль.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадпись—ервер.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадпись“аймаут.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќомер“елефона.Ўрифт = Ўрифт;
Ёлементы‘ормы.ќсновныеƒействи€‘ормы.Ўрифт = Ўрифт;
Ёлементы‘ормы.ѕароль.Ўрифт = Ўрифт;
Ёлементы‘ормы.ѕозвонить.Ўрифт =Ўрифт;
Ёлементы‘ормы.ѕоле алендар€1.Ўрифт = Ўрифт;
Ёлементы‘ормы.ѕользователь—.Ўрифт = Ўрифт;
Ёлементы‘ормы.–езультатѕоиска—писок.Ўрифт = Ўрифт;
Ёлементы‘ормы.сек.Ўрифт = Ўрифт;
Ёлементы‘ормы.—ервер.Ўрифт =Ўрифт;
Ёлементы‘ормы.—оздать—обытие.Ўрифт = Ўрифт;
Ёлементы‘ормы.—охранить.Ўрифт = Ўрифт;
Ёлементы‘ормы.—писокЌомеров онтактногоЋица.Ўрифт = Ўрифт; 
Ёлементы‘ормы.—трокаѕоиска.Ўрифт = Ўрифт;
Ёлементы‘ормы.“аймаут—екунд.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќайти.Ўрифт = Ўрифт;
Ёлементы‘ормы. артинка‘она.Ўрифт = Ўрифт;
Ёлементы‘ормы.‘лажок1.Ўрифт = Ўрифт;
Ёлементы‘ормы.—писокЌомеров онтактногоЋица.Ўрифт =Ўрифт;
Ёлементы‘ормы.–езультатѕоиска—писок.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќастройка÷вета.Ўрифт = Ўрифт;
Ёлементы‘ормы.Ќадп—оздать.Ўрифт = Ўрифт;

Ёлементы‘ормы.Ќадпись÷вет нопки.Ўрифт= Ўрифт;
Ёлементы‘ормы.Ќадпись÷вет–амки.Ўрифт= Ўрифт;
Ёлементы‘ормы.Ќадпись÷вет“екста.Ўрифт= Ўрифт;
Ёлементы‘ормы.Ќадпись÷вет‘она.Ўрифт=Ўрифт;
Ёлементы‘ормы.ѕоле.Ўрифт= Ўрифт;
Ёлементы‘ормы.ЌадписьЎрифт.Ўрифт= Ўрифт;

  онецѕроцедуры

 ѕроцедура ÷вет–амкиѕри»зменении(Ёлемент)
		//мен€ем цвет рамок объектов
	Ёлементы‘ормы.¬нутреннийЌомер.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.Ќомер“елефона.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.ѕароль.÷вет–амки =÷вет–амки; 
	Ёлементы‘ормы.–езультатѕоиска—писок.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.—ервер.÷вет–амки =÷вет–амки; 
	Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.—трокаѕоиска.÷вет–амки=÷вет–амки;
	Ёлементы‘ормы.“аймаут—екунд.÷вет–амки= ÷вет–амки;
	ѕанель.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.–амка√руппы1.÷вет–амки = ÷вет–амки;
	Ёлементы‘ормы.–амка√руппы2.÷вет–амки = ÷вет–амки;
	Ёлементы‘ормы.ѕозвонить.÷вет–амки =   ÷вет–амки;
     Ёлементы‘ормы. онтрагент.÷вет–амки =   ÷вет–амки;
	 Ёлементы‘ормы. онтактноеЋицо.÷вет–амки =  ÷вет–амки;
	 Ёлементы‘ормы.—оздать—обытие.÷вет–амки =  ÷вет–амки;
	 Ёлементы‘ормы.Ќайти.÷вет–амки =   ÷вет–амки;
      Ёлементы‘ормы. артинка‘она.÷вет–амки = ÷вет–амки;
	  Ёлементы‘ормы.—охранить.÷вет–амки = ÷вет–амки;
	    Ёлементы‘ормы.÷вет нопки.÷вет–амки =  ÷вет–амки;
	  Ёлементы‘ормы.÷ветѕол€.÷вет–амки =   ÷вет–амки;
	  Ёлементы‘ормы.÷вет–амки.÷вет–амки =   ÷вет–амки;
	  Ёлементы‘ормы.÷вет“екста.÷вет–амки =  ÷вет–амки;
	  Ёлементы‘ормы.÷вет‘она.÷вет–амки =   ÷вет–амки;
	   Ёлементы‘ормы.Ўрифт.÷вет–амки = ÷вет–амки;


  онецѕроцедуры


 ѕроцедура ÷ветѕол€ѕри»зменении(Ёлемент)
	 	Ёлементы‘ормы.Ќомер“елефона.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.–езультатѕоиска—писок.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.¬нутреннийЌомер.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.ѕароль.÷вет‘онаѕол€ =÷ветѕол€;
	Ёлементы‘ормы.—ервер.÷вет‘онаѕол€ =  ÷ветѕол€;
	Ёлементы‘ормы.“аймаут—екунд.÷вет‘онаѕол€ =   ÷ветѕол€;
	Ёлементы‘ормы.—трокаѕоиска.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.ѕользователь—.÷вет‘онаѕол€ = ÷ветѕол€;
	Ёлементы‘ормы.ѕоле алендар€1.÷вет‘онаѕол€ = ÷ветѕол€;

  онецѕроцедуры


 ѕроцедура ‘лажок1ѕри»зменении(Ёлемент)
//“екст = Ќовый “екстовыйƒокумент();
//WSS=Ќовый COMќбъект("WScript.Shell");
//	“екст.ѕрочитать(WSS.SpecialFolders().Item("AppData")+"PersonalDetails");
//	“екст.ƒобавить—троку(‘лажок1);
//	“екст.«аписать();
	
  онецѕроцедуры

